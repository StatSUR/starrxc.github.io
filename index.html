<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>World Life 服务器官网</title>
  <link rel="icon" href="favicon.png" type="image/png" />
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial; display:flex; flex-direction:column; min-height:100vh; background:#fff; color:#111; transition:background .3s, color .3s; }
    @media(prefers-color-scheme:dark) { body { background:#0f172a; color:#f8fafc; } }
    header, footer { background:linear-gradient(90deg,#0ea5e9,#6366f1); color:#fff; padding:1rem 2rem; position:sticky; width:100%; z-index:100; }
    header { display:flex; align-items:center; position:relative; }
    .title { position:absolute; left:50%; transform:translateX(-50%); font-size:1.5rem; font-weight:bold; }
    .user-info { font-size:1.2rem; font-weight:bold; padding:.2rem .6rem; border:2px solid #38bdf8; border-radius:12px; background:rgba(255,255,255,.3); cursor:default; }
    @media(prefers-color-scheme:dark) { .user-info { background:rgba(255,255,255,.1); border-color:#8b5cf6; } }
    nav { margin-left:auto; display:flex; gap:1rem; }
    nav a { color:#fff; text-decoration:none; font-weight:500; transition:color .2s; }
    nav a:hover, nav a.active { color:#facc15; }
    main { flex:1; padding:2rem; max-width:960px; margin:0 auto; }
    section { background:#f9fafb; padding:1.5rem; margin:2rem 0; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,.1); max-width:700px; margin-left:auto; margin-right:auto; transition:transform .3s, box-shadow .3s; }
    section:hover { transform:translateY(-5px); box-shadow:0 4px 20px rgba(0,0,0,.2); }
    @media(prefers-color-scheme:dark) { section { background:#1e293b; box-shadow:0 2px 8px rgba(0,0,0,.5); } section:hover { box-shadow:0 6px 24px rgba(0,0,0,.7); } }
    h2 { margin-bottom:.8rem; color:#1e40af; }
    @media(prefers-color-scheme:dark) { h2 { color:#fff; } }
    .team { display:flex; flex-wrap:wrap; gap:1rem; }
    .team span { background:#e2e8f0; padding:.5rem 1rem; border-radius:9999px; font-weight:500; }
    @media(prefers-color-scheme:dark) { .team span { background:#334155; } }
    form { display:flex; flex-direction:column; gap:1rem; }
    .input-group { position:relative; }
    input, button { padding:.6rem; border:none; border-radius:6px; font-size:1rem; width:100%; transition:background .3s; }
    input { background:#fff; border:1px solid #ccc; color:#111; }
    button { background:#3b82f6; color:#fff; cursor:pointer; }
    button:hover { opacity:.9; }
    .toggle-pw { position:absolute; top:50%; right:0.8rem; transform:translateY(-50%); cursor:pointer; font-size:1.1rem; }
    @media(prefers-color-scheme:dark) { input { background:#334155; color:#f8fafc; border:1px solid #475569; } button { background:#6366f1; } span.hint { color:#aaa; } }
    span.hint { font-size:.9rem; color:#555; }
    .fadeIn { animation:fadeIn .5s ease-in-out; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(10px);} to { opacity:1; transform:translateY(0);} }
    .modal-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.5); display:none; justify-content:center; align-items:center; }
    .modal { position:relative; background:#fff; padding:1.5rem; border-radius:8px; width:90%; max-width:400px; box-shadow:0 4px 20px rgba(0,0,0,.3); display:flex; flex-direction:column; text-align:left; }
    .modal h3 { margin-bottom:1rem; color:#1e40af; }
    .modal button.close { align-self:flex-end; background:none; border:none; font-size:1.2rem; cursor:pointer; line-height:1; }
    @media(prefers-color-scheme:dark) { .modal { background:#1e293b; color:#f8fafc; } .modal h3 { color:#facc15; } }
    .slider-captcha { user-select:none; width:100%; max-width:300px; margin:1rem 0; background:#e5e7eb; border-radius:6px; height:40px; position:relative; overflow:hidden; }
    .slider-track { position:absolute; height:100%; width:100%; background:#d1d5db; }
    .slider-fill { position:absolute; top:0; left:0; height:100%; background:#10b981; z-index:1; width:0; }
    .slider-thumb { position:absolute; top:0; left:0; width:40px; height:40px; background:#3b82f6; color:#fff; display:flex; align-items:center; justify-content:center; border-radius:6px; cursor:pointer; transition:background .3s; z-index:2; }
    .slider-success { background:#10b981!important; }
  </style>
</head>
<body>
  <header>
    <div class="user-info" id="user-info">未登录</div>
    <div class="title">World Life 官方网站</div>
    <nav>
      <a href="#home" data-page="home" onclick="switchPage(event)">首页</a>
      <a href="#server" data-page="server" onclick="switchPage(event)">服务器</a>
      <a href="#commands" data-page="commands" onclick="switchPage(event)">指令</a>
      <a href="#daily" data-page="daily" onclick="switchPage(event)">日报</a>
      <a href="#login" id="login-register-nav" data-page="login" onclick="switchPage(event)">登录/注册</a>
    </nav>
  </header>
  <main id="content"></main>
  <footer>&copy; 2025 World Life 服务器 by RXC</footer>
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal" id="modal">
      <button class="close" onclick="closeModal()">❌</button>
      <h3 id="modal-title"></h3>
      <p id="modal-message"></p>
    </div>
  </div>
  <script>
    const diaryEntries = [
      { file: 'DATE1.html', date: '2025-08-06', desc: '测试日报。' },
      { file: 'DATE2.html', date: '2025-08-05', desc: '服务器维护，优化了地图加载速度。' }
    ];

    function getHomePage() {
      return `<section class="fadeIn"><h2>欢迎来到 World Life 服务器</h2><p>这是一个虚拟的 Minecraft 世界，你可以加入不同省份，扮演多种角色~</p></section>` +
             `<section class="fadeIn"><h2>世界地图玩法</h2><p>在1:1000比例的世界地图中，可加入或创建省份~</p></section>` +
             `<section class="fadeIn"><h2>主要人员</h2><div class="team"><span>服主：星星 RXC</span><span>建服者：洛白</span><span>管理员：CHLovo</span><span>玩家：欢迎加入！</span></div></section>`;
    }

    function getDailyPage() {
      let list = '<ul>';
      diaryEntries.forEach(entry => {
        list += `<li><a href="${entry.file}" target="_blank">${entry.date}</a> — ${entry.desc}</li>`;
      });
      list += '</ul>';
      return `<section class="fadeIn"><h2>服务器日报列表</h2>${list}</section>`;
    }

    function getLoginPage() {
      return `<section class="fadeIn"><h2>请登录~</h2><form onsubmit="handleLogin(event)">` +
             `<div class="input-group"><input id="login-username" type="text" placeholder="用户名" required minlength="3"/></div>` +
             `<div class="input-group"><input id="login-password" type="password" placeholder="密码" required/>` +
             `<span class="toggle-pw" onclick="togglePassword('login-password')">👁️</span></div>` +
             `<button type="submit">登录</button></form></section>` +
             `<section class="fadeIn"><h2>注册新账户~</h2><form onsubmit="handleRegister(event)">` +
             `<div class="input-group"><input id="register-username" type="text" placeholder="新用户名（至少3字符）" required minlength="3"/></div>` +
             `<div class="input-group"><input id="register-password" type="password" placeholder="新密码（8-16位）" pattern=".{8,16}" required/>` +
             `<span class="toggle-pw" onclick="togglePassword('register-password')">👁️</span></div>` +
             `<span class="hint">密码长度需8-16位~</span>` +
             `<div class="input-group"><input id="register-confirm" type="password" placeholder="确认密码" required/>` +
             `<span class="toggle-pw" onclick="togglePassword('register-confirm')">👁️</span></div>` +
             `<div class="slider-captcha" id="slider"><div class="slider-track"></div><div class="slider-fill"></div><div class="slider-thumb" id="slider-thumb">⏩</div>` +
             `<input type="hidden" id="captcha-verified" value="false"/><span class="hint">拖动滑块完成验证~</span></div>` +
             `<button type="submit">注册</button></form></section>`;
    }

    const pages = {
      home: getHomePage(),
      server: `<section class="fadeIn"><h2>如何加入服务器</h2><p>加入我们的QQ群：749664574~</p></section>`,
      commands: `<section class="fadeIn"><h2>常用指令列表</h2><ul><li>/reg 密码 密码：注册</li><li>/login 密码：登录</li><li>/tpa 玩家名：传送请求</li><li>/tpahere 玩家名：请求对方传送</li><li>/back：回到死亡/传送点</li><li>/co i：启用/关闭检查器</li></ul></section>`,
      daily: getDailyPage(),
      login: ''
    };

    function updateUserInfo() {
      const user = localStorage.getItem('currentUser');
      const userInfo = document.getElementById('user-info');
      const loginNav = document.getElementById('login-register-nav');
      if (user) {
        userInfo.innerHTML = `您好，${user} | <a href="#" onclick="logoutUser()">注销</a>`;
        loginNav.textContent = '我的信息';
        pages.login = `<section class="fadeIn"><h2>当前用户信息</h2><p>用户名：${user}</p><p>登录时间：${new Date().toLocaleString()}</p><button onclick="logoutUser()">注销</button></section>`;
      } else {
        userInfo.textContent = '未登录';
        loginNav.textContent = '登录/注册';
        pages.login = getLoginPage();
      }
    }

    function switchPage(e) {
      e.preventDefault();
      document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
      e.currentTarget.classList.add('active');
      updateUserInfo();
      const page = e.currentTarget.dataset.page;
      document.getElementById('content').innerHTML = pages[page] || '';
      if (page === 'login' && !localStorage.getItem('currentUser')) initSliderCaptcha();
    }

    function logoutUser(){
      localStorage.removeItem('currentUser');
      updateUserInfo();
      pages.login = getLoginPage();
      showModal('已注销','您已成功退出登录');
      document.querySelector('nav a[data-page="home"]').click();
    }

    function showModal(title,msg){
      document.getElementById('modal-title').textContent=title;
      document.getElementById('modal-message').textContent=msg;
      document.getElementById('modal-overlay').style.display='flex';
    }

    function closeModal(){
      document.getElementById('modal-overlay').style.display='none';
    }

    function handleLogin(e){
      e.preventDefault();
      const user=document.getElementById('login-username').value;
      const pass=document.getElementById('login-password').value;
      const users=JSON.parse(localStorage.getItem('users')||'{}');
      if(!users.hasOwnProperty(user))showModal('登录失败','没有此账户！');
      else if(users[user]!==pass)showModal('登录失败','密码错误！');
      else{
        localStorage.setItem('currentUser',user);
        updateUserInfo();
        showModal('登录成功',`欢迎回来，${user}！`);
        document.querySelector('nav a[data-page="home"]').click();
      }
    }

    function handleRegister(e) {
      e.preventDefault();
      const user = document.getElementById('register-username').value;
      const pass = document.getElementById('register-password').value;
      const conf = document.getElementById('register-confirm').value;
      const passed = document.getElementById('captcha-verified').value === 'true';
      const users = JSON.parse(localStorage.getItem('users')||'{}');
      if (!passed) return showModal('注册失败', '请完成滑块验证~');
      if (pass !== conf) return showModal('注册失败', '两次密码不一致~');
      if (pass.length<8||pass.length>16) return showModal('注册失败', '密码长度需8-16位~');
      if (users[user]) return showModal('注册失败', '用户名已存在~');
      users[user] = pass;
      localStorage.setItem('users', JSON.stringify(users));
      showModal('注册成功','注册成功~');
      document.querySelector('nav a[data-page="login"]').click();
    }

    function initSliderCaptcha() {
      const thumb=document.getElementById('slider-thumb');
      const track=document.getElementById('slider');
      if(!thumb||!track)return;
      thumb.style.left='0';
      document.getElementById('captcha-verified').value='false';
      const fill=track.querySelector('.slider-fill');
      fill.style.width='0';
      let dragging=false,startX=0;
      thumb.onmousedown=e=>{dragging=true;startX=e.clientX;document.onmousemove=drag;document.onmouseup=stop;};
      function drag(e){
        if(!dragging) return;
        let d=e.clientX-startX;
        d=Math.max(0,Math.min(d,track.offsetWidth-thumb.offsetWidth));
        thumb.style.left=d+"px";
        fill.style.width=d+"px";
      }
      function stop(){
        dragging=false;document.onmousemove=null;document.onmouseup=null;
        if(parseInt(thumb.style.left)>=track.offsetWidth-thumb.offsetWidth-2){
          thumb.classList.add('slider-success');
          thumb.textContent='✅';
          document.getElementById('captcha-verified').value='true';
          thumb.onmousedown=null;
        } else {
          thumb.style.left='0'; fill.style.width='0';
        }
      }
    }

    function togglePassword(id) {
      const input = document.getElementById(id);
      input.type = input.type === 'password' ? 'text' : 'password';
    }

    window.onload = () => {
      updateUserInfo();
      document.querySelector('nav a[data-page="home"]').click();
    };
  </script>
</body>
</html>

